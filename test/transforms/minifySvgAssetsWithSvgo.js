/*global describe, it*/
var expect = require('../unexpected-with-plugins'),
    AssetGraph = require('../../lib');

describe('transforms/minifySvgAssetsWithSvgo', function () {
    it('should handle a simple test case', function (done) {
        new AssetGraph({root: __dirname + '/../../testdata/transforms/minifySvgAssetsWithSvgo/'})
            .loadAssets('index.html')
            .populate()
            .queue(function (assetGraph) {
                expect(assetGraph, 'to contain asset', 'Svg');
            })
            .minifySvgAssetsWithSvgo({type: 'Svg'})
            .queue(function (assetGraph) {
                expect(assetGraph, 'to contain asset', 'Svg');
                expect(
                    assetGraph.findAssets({type: 'Svg'})[0].text,
                    'to equal',
                    '<svg height="56.693" viewBox="0 0 56.693 56.693" width="56.693" xmlns="http://www.w3.org/2000/svg"><g fill="#474A56"><circle cx="47.089" cy="40.805" r="3.129"/><circle cx="9.67" cy="37.212" r="3.129"/><circle cx="14.467" cy="8.241" r="3.13"/><path d="M19.114 14.647L17.9 12.384c-.278-.52-.922-.715-1.444-.436-.517.277-.714.924-.436 1.444l1.217 2.263c.19.357.558.564.938.564.17 0 .344-.043.505-.13.518-.277.713-.925.434-1.443zM20.27 21.313c.193.36.562.564.942.564.172 0 .342-.04.502-.127.52-.28.713-.926.436-1.445l-1.215-2.263c-.278-.518-.924-.714-1.444-.435-.52.28-.71.925-.434 1.443l1.214 2.263zM35.98 33.542l-2.47-1.41c-.512-.293-1.163-.114-1.456.396-.29.512-.113 1.163.4 1.455l2.468 1.41c.167.096.35.14.528.14.373 0 .73-.192.928-.538.293-.51.114-1.163-.398-1.453zM42.157 37.066l-2.472-1.41c-.512-.29-1.162-.113-1.455.397-.29.513-.113 1.163.397 1.456l2.47 1.408c.17.096.35.14.53.14.368 0 .728-.193.925-.538.29-.51.113-1.162-.395-1.454zM17.152 32.173l-2.487 1.375c-.517.286-.705.935-.418 1.45.194.35.56.55.934.55.175 0 .353-.043.516-.133l2.487-1.377c.517-.285.704-.934.42-1.45-.287-.514-.937-.702-1.45-.415z"/><path d="M48.662 9.463c0-2.63-2.138-4.766-4.767-4.766-2.625 0-4.765 2.137-4.765 4.766 0 .838.22 1.624.6 2.31L28.863 23.18c-.986-.6-2.14-.947-3.373-.947-3.612 0-6.55 2.937-6.55 6.546 0 3.607 2.938 6.545 6.55 6.545.066 0 .127-.008.196-.01l2.428 9.53c-1.356.84-2.268 2.34-2.268 4.05 0 2.628 2.14 4.765 4.767 4.765 2.626 0 4.764-2.137 4.764-4.765 0-2.54-2-4.617-4.507-4.752l-2.43-9.53c2.13-1.08 3.594-3.287 3.594-5.834 0-1.348-.408-2.602-1.11-3.643l10.87-11.405c.635.316 1.348.496 2.103.496 2.627 0 4.765-2.137 4.765-4.765zM28.692 47.11c.48-.518 1.16-.848 1.92-.848.293 0 .57.06.835.15 1.04.35 1.798 1.324 1.798 2.482 0 1.452-1.183 2.633-2.633 2.633s-2.633-1.18-2.633-2.633c0-.69.272-1.314.71-1.785zm.396-17.502c-.166.72-.54 1.358-1.06 1.85-.1.097-.21.183-.322.27-.62.467-1.384.754-2.217.754-.186 0-.363-.028-.54-.054-.787-.116-1.497-.47-2.043-1-.51-.5-.878-1.143-1.035-1.867-.055-.25-.088-.51-.088-.78 0-1.03.43-1.966 1.112-2.638.496-.487 1.126-.837 1.832-.985.245-.05.5-.078.76-.078.467 0 .91.095 1.32.253.922.354 1.666 1.06 2.065 1.958.202.457.317.96.317 1.49 0 .285-.04.56-.102.828zm14.807-17.513c-.168 0-.334-.02-.495-.05-1.013-.194-1.814-.97-2.055-1.966-.05-.2-.08-.405-.08-.617 0-1.452 1.18-2.634 2.63-2.634 1.452 0 2.633 1.18 2.633 2.633 0 1.452-1.18 2.632-2.633 2.632z"/></g></svg>'
                );
            })
            .run(done);
    });
});
